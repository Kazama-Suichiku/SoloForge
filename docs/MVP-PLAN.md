# SoloForge MVP 阶段规划方案

> 一人公司多 Agent 桌面应用 · 本地优先 · Electron 跨平台（Mac + Windows）

---

## 一、MVP 核心目标与边界

### 1.1 核心目标

MVP 阶段的目标是：**交付一个可运行、可演示的最小可用版本**，验证「一人公司 + 多 Agent 协作」的核心理念是否可行。

具体包括：

- **可启动**：Electron 应用能在 Mac / Windows 上正常打开并显示主界面
- **可交互**：用户能通过 UI 发起任务、查看结果
- **可协作**：至少 2 个 Agent 能串联完成一个端到端示例流程
- **本地优先**：核心逻辑在本地运行，无强制云端依赖

### 1.2 MVP 边界（做什么 / 不做什么）

| 做 | 不做 |
|---|---|
| Electron 基础框架 + 主窗口 | 多窗口、系统托盘 |
| 1 个完整的 Agent 协作示例（如：写邮件 → 审核） | 复杂的 Agent 编排、可配置工作流 |
| 本地 LLM / API 调用（二选一先打通一个） | 多模型切换、模型管理 |
| 简单的任务列表与状态展示 | 完整任务管理、历史记录、搜索 |
| 基础 IPC 通信 | 复杂状态同步、多进程架构 |
| 深色/浅色主题切换 | 完整主题系统、自定义皮肤 |

### 1.3 成功标准

- [ ] 应用可在 Mac 和 Windows 上启动并稳定运行
- [ ] 用户能输入一个任务（如「写一封感谢客户的邮件」），看到 Agent 协作过程与最终输出
- [ ] 至少 2 个 Agent 串联执行，流程可观测（日志或进度提示）
- [ ] 无硬编码敏感信息，API Key 可配置

---

## 二、MVP 任务拆解

### 阶段概览

```
阶段 1：项目基础 (T01-T04)
    ↓
阶段 2：Agent 核心 (T05-T07)
    ↓
阶段 3：UI 与集成 (T08-T11)
    ↓
阶段 4：打磨与交付 (T12-T14)
```

---

### 阶段 1：项目基础

| 编号 | 标题 | 描述 | 预估工时 | 依赖 |
|------|------|------|----------|------|
| **T01** | 初始化 Electron 项目 | 使用 electron-vite 或 create-electron-vite 创建项目，配置 TypeScript、ESLint、Prettier。确保 main / renderer / preload 目录清晰，contextIsolation 开启。 | 1-2h | 无 |
| **T02** | 配置跨平台构建 | 配置 electron-builder，支持 Mac (dmg/pkg) 和 Windows (exe/msi)。设置基础 package.json scripts、输出目录。验证本地 `npm run build` 可产出安装包。 | 1-2h | T01 |
| **T03** | 搭建前端基础框架 | 选型并集成 React + 状态管理(Zustand/Jotai) + Tailwind CSS。创建基础布局（侧栏 + 主内容区），实现深色/浅色主题切换。 | 2-3h | T01 |
| **T04** | 定义 IPC 通信规范 | 在 preload 暴露安全的 API（如 `window.electron.invoke`），主进程实现 2-3 个示例 handler。文档化 IPC channel 命名规范与参数约定。 | 1-2h | T01 |

---

### 阶段 2：Agent 核心

| 编号 | 标题 | 描述 | 预估工时 | 依赖 |
|------|------|------|----------|------|
| **T05** | 设计 Agent 基础架构 | 定义 Agent 接口（输入 schema、输出 schema）、执行器抽象。实现一个「占位 Agent」可接收任务并返回模拟结果。 | 2-3h | T04 |
| **T06** | 接入 LLM 调用 | 选择一个 LLM 接入方式（OpenAI API / 本地 Ollama / LiteLLM 等），实现 `callLLM(prompt)` 基础能力。API Key 从环境变量或配置文件读取。 | 2-3h | T05 |
| **T07** | 实现 2-Agent 串联示例 | 实现「Writer Agent」+「Reviewer Agent」流水线：Writer 生成初稿 → Reviewer 审核并给出修改建议 → 返回最终文本。支持进度回调供 UI 展示。 | 2-3h | T05, T06 |

---

### 阶段 3：UI 与集成

| 编号 | 标题 | 描述 | 预估工时 | 依赖 |
|------|------|------|----------|------|
| **T08** | 任务输入与发起 UI | 创建任务输入区域（文本框 + 按钮），支持用户输入任务描述。点击后通过 IPC 调用主进程的「执行 Agent 流程」接口。 | 1-2h | T03, T04 |
| **T09** | 任务执行状态展示 | 展示执行中 / 完成 / 失败状态，支持进度步骤（如「Writer 执行中」「Reviewer 执行中」）。接收主进程通过 IPC 推送的进度事件。 | 1-2h | T08, T07 |
| **T10** | 结果展示与基础样式 | 展示 Agent 最终输出（文本区域），支持复制、导出为文件（可选）。统一 UI 风格，确保 Mac / Windows 上视觉一致。 | 1-2h | T09 |
| **T11** | 主进程集成 Agent 流程 | 在主进程中串联 IPC handler 与 Agent 执行器。任务请求进入后触发 T07 的流水线，进度与结果通过 IPC 回传 renderer。 | 1-2h | T07, T08 |

---

### 阶段 4：打磨与交付

| 编号 | 标题 | 描述 | 预估工时 | 依赖 |
|------|------|------|----------|------|
| **T12** | 错误处理与降级 | 网络/API 失败时给出友好提示，支持重试。LLM 不可用时返回明确的错误信息，避免白屏或卡死。 | 1-2h | T10, T11 |
| **T13** | 跨平台验证与修复 | 在 Mac 和 Windows 上分别运行、打包，修复平台差异（路径、快捷键、窗口行为等）。 | 2-3h | T02, T11 |
| **T14** | 文档与发布准备 | 编写 README（安装、运行、配置说明）、环境变量说明。准备 0.1.0 版本发布 checklist。 | 1-2h | T13 |

---

## 三、依赖关系图

```text
T01 ──┬── T02
      ├── T03 ──┬── T08 ── T09 ── T10 ── T12
      └── T04 ──┼── T05 ── T06
                │      └── T07 ── T11
                └──────────────┘
                
T02, T11 ── T13 ── T14
```

### 建议执行顺序

1. **第一周**：T01 → T02 → T03 → T04  
2. **第二周**：T05 → T06 → T07 → T11  
3. **第三周**：T08 → T09 → T10 → T12  
4. **第四周**：T13 → T14  

---

## 四、里程碑节点

| 里程碑 | 包含任务 | 可演示内容 | 预计时间点 |
|--------|----------|------------|------------|
| **M1：框架就绪** | T01-T04 | Electron 应用可启动，有基础 UI，IPC 可通 | 第 1 周末 |
| **M2：Agent 可运行** | T05-T07, T11 | 主进程可执行 2-Agent 流水线并返回结果 | 第 2 周末 |
| **M3：端到端可用** | T08-T10 | 用户在 UI 输入任务，看到进度与结果 | 第 3 周末 |
| **M4：MVP 交付** | T12-T14 | 跨平台打包完成，文档齐全，可对外演示 | 第 4 周末 |

---

## 五、风险与建议

### 5.1 技术风险

| 风险 | 影响 | 缓解措施 |
|------|------|----------|
| LLM API 成本/限流 | 开发测试频繁调用可能超限 | 优先考虑本地 Ollama；或使用 mock 模式开发 |
| Electron 打包体积大 | 安装包体积可能超 150MB | MVP 阶段接受，后续可考虑 ASAR 优化、按需加载 |
| 跨平台行为差异 | 部分功能在 Win 上表现不同 | T13 专门预留时间，提前在双平台测试 |

### 5.2 架构建议

1. **Agent 层与 UI 层解耦**：Agent 逻辑放在 main 或独立模块，不依赖 React，便于后续扩展更多 Agent。
2. **先打通一个 LLM 源**：建议先支持 Ollama（本地免费）或 OpenAI API（易调试），不要同时支持多源增加复杂度。
3. **进度通信**：使用 `ipcRenderer.invoke` + `mainWindow.webContents.send` 组合，主进程可主动推送进度，无需轮询。

### 5.3 可延后项（超出 MVP）

- 系统托盘、多窗口、快捷键
- 任务历史、持久化存储
- 可配置的 Agent 工作流编辑器
- 多模型切换、模型管理
- 自动更新、代码签名

---

## 六、任务清单（速查）

| # | 任务 | 依赖 |
|---|------|------|
| T01 | 初始化 Electron 项目 | - |
| T02 | 配置跨平台构建 | T01 |
| T03 | 搭建前端基础框架 | T01 |
| T04 | 定义 IPC 通信规范 | T01 |
| T05 | 设计 Agent 基础架构 | T04 |
| T06 | 接入 LLM 调用 | T05 |
| T07 | 实现 2-Agent 串联示例 | T05, T06 |
| T08 | 任务输入与发起 UI | T03, T04 |
| T09 | 任务执行状态展示 | T08, T07 |
| T10 | 结果展示与基础样式 | T09 |
| T11 | 主进程集成 Agent 流程 | T07, T08 |
| T12 | 错误处理与降级 | T10, T11 |
| T13 | 跨平台验证与修复 | T02, T11 |
| T14 | 文档与发布准备 | T13 |

---

*文档版本：v1.0 · 创建日期：2025-02-14*
